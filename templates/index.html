<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Diabetes Prediction using Machine Learning as a tool</title>
  
    <!-- Our CSS -->
    <link rel="stylesheet" type="text/css" href="../static/js/style.css">
    <link rel="stylesheet" type="text/css" href="../static/js/index.js">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
</head>

<body>
    <div class="main-container">
       <header class="main-header " id="main-header">
           <div class="header-wrap" height="75px">
               <h1 class="Logo">
               <a href="/" class="Logo_small">
                <img src="https://i.pinimg.com/474x/8f/a4/c1/8fa4c1a81470155ff9933bd5cfe37b86.jpg" width="100px" height="75px">
            </a>
            <span class="Navbar-text">Meta-B: Diabetes Predictors Using Machine Learning as a Tool</span>
        </h1>
        <input type="button" value="Click here to submit a diagnostic Form" onClick="document.getElementById('form').scrollIntoView();" />
           </div>
       </header>
       <div class="intro col-md-12">
           <h2>Our Challenge</h2>

           <p class="tab">Currently, one in three Canadians has diabetes or prediabetes. Previous research shows that those 20 years of age 
               today face a 50 per cent chance of developing diabetes in their lifetime. We want to know, can AI predict diabetes with high accuracy? 
               With AI and machine learning gathering traction in the last decade we decided to 
               test this theory ourselves. With our knowdlege of font and back-end programming we sought out to get ourselves a viable dataset 
               and test our skills to see if an AI could be an accurate predictor for diabetes based on certain parameters. We 
               initially hypothesised that our machine learning model would be accurate above 50% but we were unsure if it could reach 80% and above.
               Our main challenges were finding a viable dataset with enough measures and entries to help our model become more accurate.
                It was a painstaking process to scour the web for a dataset containing at least 5,000 entries, something we didn't expect.
                Unfortunately, when we did find one, we encountered a big problem, cleaning the data and getting rid of unwanted variables
                and irrelevant information we deemed unlikely to be a factor in predicting diabetes cases. Thankfully, Our team member Taj
                worked his magic and managed to spare us approximately 3,200 samples, all cleaned and ready to go! Angela, the brains behind 
                our machine learning model, quickly got to work on structuring the training and testing data as well as spoon feeding our model
                algorithm after algorithm in an effort to secure our best chance at attaining a highly accurate model.
           </p>
        </div>
        <div class="dataset-info col-md-12">
           <h2>Our Data</h2>
           <p class="tab">We found a pre-existing dataset on Kaggle of compiled diabetic and nondiabetic patients involved in testing featuring 
           desireable measures. Our original dataset contained over 5,000 entries and 62 columns. After a much needed clean-up
           and running our data through a Random Forest algorithm to determine our biggest factors and contributors in diabetics, we cut that number
           down to 3,200 entries and 34 columns. Each column factors in a bias/weight of at least 1% into our data, up to approximately
           20% for our highest common factor among diabetics. Although the dataset is nowhere near the 10,000 entries we would have hoped
           it gave us insights into what are early signs and which demographics are at the highest risk. </p>
    
           <p class="tab">
           Of course with our progress we also encountered some limitations. Our data does not contain information regarding if diabetes is 
           prevalent in their family history. As we all know, this is a big factor as mutations that facilitate developing diabetes can be passed
           on. On the brightside, we already know that factors in, which leaves us to test how likely our lifestyles can impact our development of this disease.
           <p>
       </div>

       <div class="process col-md-12">
        <h2>Our Process</h2>
        <p class="tab"> We determined our data had three possible outomes: Diabetic, Non-diabetic, Pre-diabetic. After running the model in the beginning,
             our scores resulted in low or very low accuracy and recall in the Pre-diabetic class. As a result we decided to drop that 
             class to increase our models chances of success. We hoped this increased our models successful probability rate. Next, we began with 
             a designing a logistic regression model which we then scaled, trained, fit, and tested trained data on. The results were as follows: <br>
             <b>Training data score:</b> 0.917. <br>
            <b>Testing data score:</b> 0.991.<br>
            <b>Recall:</b> 0.40.<br>
        </p>
        <p>
            Our second approach we applied a Deep Learning model. The first step we took was reversing the values of the outcome (E.g. 
            1= Not diabetic -> 0= Not diabetic , 0=Diabetic -> 1=Diabetic ). The next step was solving the problem of imbalanced data 
            by applying a Synthetic Minority Oversampling Technique (SMOTE) to balance the data. We then fitted, scaled, hot-encoded,
            and defined the 5 hidden layers of our Neural Network each with <b>102</b> neurons and an input dimension of <b>32</b> and 
            output of <b>2</b>. The results from this testing was:
            <br><b>Precision (Non-diabetic):</b> 0.9.
            <br><b>Precision (Diabetic): </b>0.4.
            <br><b>Recall (Non-diabetic): </b>1.00.
            <br><b>Recall (Diabetic):</b> 0.03.

        </p>
        <p>
            Finally, we optimized our model using an SVM (Support Vector Machine) algorithm to find the optimal hyperplane to separate
            diabetics from non-diabetics. Again we reversed the outcome values, followed by splitting and scaling the data, 
            creating a grid search estimator, and fitting the data to the model.Our final prediction pesulted in:
            <br><b>Precision (Non-diabetic):</b> 0.96.
            <br><b>Precision (Diabetic): </b>0.88.
            <br><b>Recall (Non-diabetic): </b>0.99.
            <br><b>Recall (Diabetic):</b> 0.62.

        </p>
       </div>

       <div class="tableau col-md-12" id="block_container">
           
            <h2>Our Findings</h2>
            <img src="https://law-review.sumdu.edu.ua/wp-content/uploads/2016/04/Simple-Blue-Background.jpg"
            height="30px" width="1300px" class="img" >
            <p1> One of the interesting insights we've gained by looking at the data was how diabetes prevalance increases with age.
                This is likely due to lifestyle choices and health factors such as activity levels as well as genetics.
                 <div class='tableauPlaceholder' id='viz1604971697617' style='position: relative' ><noscript><a href='#'><img alt=' ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;Di&#47;DiabetesAssignment&#47;Story1&#47;1_rss.png' style='border: none' /></a></noscript><object class='tableauViz'  style='display:inline-block;'><param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' /> <param name='embed_code_version' value='3' /> <param name='site_root' value='' /><param name='name' value='DiabetesAssignment&#47;Story1' /><param name='tabs' value='no' /><param name='toolbar' value='yes' /><param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;Di&#47;DiabetesAssignment&#47;Story1&#47;1.png' /> <param name='animate_transition' value='yes' /><param name='display_static_image' value='yes' /><param name='display_spinner' value='yes' /><param name='display_overlay' value='yes' /><param name='display_count' value='yes' /><param name='language' value='en' /></object></div>                <script type='text/javascript'>                    var divElement = document.getElementById('viz1604971697617');                    var vizElement = divElement.getElementsByTagName('object')[0];                    vizElement.style.width='616px';vizElement.style.height='591px';                    var scriptElement = document.createElement('script');                    scriptElement.src = 'https://public.tableau.com/javascripts/api/viz_v1.js';                    vizElement.parentNode.insertBefore(scriptElement, vizElement);                </script>
                 <p2>- (fig. 1 )Diabetes prevalance changes based on race. For example, we found diabetes was almost twice as common
                     in Black indviduals than Asian individuals.<br>
                     (fig.2) Prevalance of diabetes decreases with each increasing level of education.<br>
                     (fig.3) Diabetes tends to decrease as income increases.<br>
                     (fig.4) Diabetes prevalance increases with age.<br>
                     (fig.5) More diabetics have health insurance than not , Most likely due to the medical expenses associated with
                     a chronic disease.
                 </p2>
                 <div class='tableauPlaceholder' id='viz1605035080255' style='position: relative'><noscript><a href='#'><img alt=' ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;Di&#47;Diabetes_16047688060260&#47;Dashboard1&#47;1_rss.png' style='border: none' /></a></noscript><object class='tableauViz'  style='display:none;'><param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' /> <param name='embed_code_version' value='3' /> <param name='site_root' value='' /><param name='name' value='Diabetes_16047688060260&#47;Dashboard1' /><param name='tabs' value='no' /><param name='toolbar' value='yes' /><param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;Di&#47;Diabetes_16047688060260&#47;Dashboard1&#47;1.png' /> <param name='animate_transition' value='yes' /><param name='display_static_image' value='yes' /><param name='display_spinner' value='yes' /><param name='display_overlay' value='yes' /><param name='display_count' value='yes' /><param name='language' value='en' /><param name='filter' value='publish=yes' /></object></div>                <script type='text/javascript'>                    var divElement = document.getElementById('viz1605035080255');                    var vizElement = divElement.getElementsByTagName('object')[0];                    if ( divElement.offsetWidth > 800 ) { vizElement.style.width='1000px';vizElement.style.height='727px';} else if ( divElement.offsetWidth > 500 ) { vizElement.style.width='1000px';vizElement.style.height='727px';} else { vizElement.style.width='100%';vizElement.style.height='727px';}                     var scriptElement = document.createElement('script');                    scriptElement.src = 'https://public.tableau.com/javascripts/api/viz_v1.js';                    vizElement.parentNode.insertBefore(scriptElement, vizElement);                </script>
                 <p2>
                     - BMI is a common factor among diabetics. When the chart is filtered (you can click the colored boxes at the top right!)
                     diabetics tend to have a higher BMI than their counterparts. High BMI, however,is also present in non-diabetics as well, meaning 
                     diabetes could be a combination of diet and exercise as well as genetic influencers. On our BMI scale, according to the CDC,
                     a BMI equal to and above 30 is considered obese. A BMI of 40 and above is considered morbid obesity.
                 </p2>
                 <div class='tableauPlaceholder' id='viz1605035540401' style='position: relative'><noscript><a href='#'><img alt=' ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;Di&#47;Diabetes_16047688060260&#47;Dashboard3&#47;1_rss.png' style='border: none' /></a></noscript><object class='tableauViz'  style='display:none;'><param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' /> <param name='embed_code_version' value='3' /> <param name='site_root' value='' /><param name='name' value='Diabetes_16047688060260&#47;Dashboard3' /><param name='tabs' value='no' /><param name='toolbar' value='yes' /><param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;Di&#47;Diabetes_16047688060260&#47;Dashboard3&#47;1.png' /> <param name='animate_transition' value='yes' /><param name='display_static_image' value='yes' /><param name='display_spinner' value='yes' /><param name='display_overlay' value='yes' /><param name='display_count' value='yes' /><param name='language' value='en' /></object></div>                <script type='text/javascript'>                    var divElement = document.getElementById('viz1605035540401');                    var vizElement = divElement.getElementsByTagName('object')[0];                    if ( divElement.offsetWidth > 800 ) { vizElement.style.width='1100px';vizElement.style.height='727px';} else if ( divElement.offsetWidth > 500 ) { vizElement.style.width='1100px';vizElement.style.height='727px';} else { vizElement.style.width='100%';vizElement.style.height='777px';}                     var scriptElement = document.createElement('script');                    scriptElement.src = 'https://public.tableau.com/javascripts/api/viz_v1.js';                    vizElement.parentNode.insertBefore(scriptElement, vizElement);                </script>
                <p2>
                    - In the visualization above, we compare glucose levels and BMI of diabetics vs. Non-diabetics. We can see
                    that glucose levels are much higher and more varying in diabetics than non-diabetics. We also see much higher 
                    BMI's in diabetics than non-diabetics of the same age group. For reference here, glucose levels between 120-140 is on the extreme
                    spectrum for healthy individuals and 200 and above is extremely dangerous.
                </p2>
                <div class='tableauPlaceholder' id='viz1605038113407' style='position: relative'><noscript><a href='#'><img alt=' ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;Di&#47;Diabetes_16047688060260&#47;Dashboard2&#47;1_rss.png' style='border: none' /></a></noscript><object class='tableauViz'  style='display:none;'><param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' /> <param name='embed_code_version' value='3' /> <param name='site_root' value='' /><param name='name' value='Diabetes_16047688060260&#47;Dashboard2' /><param name='tabs' value='no' /><param name='toolbar' value='yes' /><param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;Di&#47;Diabetes_16047688060260&#47;Dashboard2&#47;1.png' /> <param name='animate_transition' value='yes' /><param name='display_static_image' value='yes' /><param name='display_spinner' value='yes' /><param name='display_overlay' value='yes' /><param name='display_count' value='yes' /><param name='language' value='en' /><param name='filter' value='publish=yes' /></object></div>                <script type='text/javascript'>                    var divElement = document.getElementById('viz1605038113407');                    var vizElement = divElement.getElementsByTagName('object')[0];                    if ( divElement.offsetWidth > 800 ) { vizElement.style.width='750px';vizElement.style.height='787px';} else if ( divElement.offsetWidth > 500 ) { vizElement.style.width='750px';vizElement.style.height='787px';} else { vizElement.style.width='100%';vizElement.style.height='727px';}                     var scriptElement = document.createElement('script');                    scriptElement.src = 'https://public.tableau.com/javascripts/api/viz_v1.js';                    vizElement.parentNode.insertBefore(scriptElement, vizElement);                </script>
                <p2>
                    -In the diagram here we explore the relationship between diabetes and grip strength. Although grip strength
                    varies from one individual to another, we can conclude that a weaker grip strength could be a secondary effect of
                    diabetes, or in the case on non-diabetics, could be a sign of the individual being at risk of developing diabetes (when other 
                    factors such as high BMI and glucose levels are present).
                </p2>
                 </p1>
           </div>
        
       <div class="conclusion col-md-12">
           <h2>Conclusion</h2>
           <p>  
            We ended up deciding on using SVM model to predict diabetes in our application we created. The high precision scores
            for both classes and high recall scores for diabetes prediction made it optimal for potentially diagnosing diabetes and reducing
            the risk of false negatives in our predictions. Our goal now is to continue adding data to our model as this will increased
            it's accuracy and could potentially give us more insights into early warning signs for people at risk of diabetes.
           </p><br>
           <p>
            Below you can find a Diagnostic form where you can input your data anonymously. Your data will serve to improve our model as well 
            as expand on the existing database in hopes that in the future we can use it to improve future research.
           </p>
       </div>
       <div class="container col-md-12">
        <div class="jumbotron" id= 'form' style="text-align: center">
            <h1>Diabetes Diagnostics</h1>
            <p>Please fill out the survey below !</p>
        </div>
        <div class="row">
            <div class="col-md-offset-2 col-md-8">
                <form method="POST" action="/predict" role="form", name="Diabetesform" class="Form">
                   
                </form>
            </div>
        </div>
    <div class ="row" >
    <!-- Add Welcome message with name and hobby served from backend -->
    <h1>Results: </h1>
    <p> {{results}}</p>
  </div>
       </div>
       <footer>
        <div class="container">
            <div class="row">
                <div class="col">
                    <h4 class="text-center">© Copyright META-B 2020 © </h4>
                </div>
            </div>
    </footer>
    </div>
        
</body>

<script type="text/javascript" src="../static/js/config.js"></script>
<!-- Our JS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/5.5.0/d3.js"></script>
<script type="text/javascript" src="../static/js/app.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>

</html>